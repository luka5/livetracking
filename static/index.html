<html>
  <head>
     <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin=""/>
  </head>
  <body>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>

    <script src="/leaflet-gpx/gpx.js"></script>

    <div id="mapid" style="width: 600px; height: 400px;"></div>

    <script>

        var map = L.map('mapid').setView([48.358, 9.97197], 12);
        
        L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            id: 'mapbox/streets-v11',
            tileSize: 512,
            zoomOffset: -1
        }).addTo(map);
        
        var gpxUrl = '/api/v1/gpx';
        var gpx = new L.GPX(gpxUrl, {
            async: true,
            marker_options: {
                startIconUrl: 'leaflet-gpx/pin-icon-start.png',
                endIconUrl: 'leaflet-gpx/pin-icon-end.png',
                shadowUrl: 'leaflet-gpx/pin-shadow.png'
            }
        }).on('loaded', function(e) {
            map.fitBounds(e.target.getBounds());
        }).addTo(map);
        
        setInterval(function() {
            gpx.reload();
        }, 30000);

    </script>

  </body>
</html>
